function disableSaveBtn(){var e=0;$("#hours_active_container").hasClass("hidden")||(e+=checkActiveHours()),$("#days_and_hours_active_container").hasClass("hidden")||(e+=checkActiveWeek()),$("#add_local_ip_form_group").hasClass("hidden")||(e+=checkLocalIPs()),$("#resources_container").hasClass("hidden")||($("#add_remote_ip_form_group").hasClass("hidden")||(e+=checkRemoteIPs()),$("#local_port_container").hasClass("hidden")||(e+=checkPort("local_port")),$("#remote_port_container").hasClass("hidden")||(e+=checkPort("remote_port"))),e?$("#form_submit_btn").prop("disabled",!0):$("#form_submit_btn").prop("disabled",!1)}function checkLocalIPs(){var e=0,t=$("#applies_to_addr").val();return 0!=t.length&&validateMultipleIps(t)&&validateMac(t)?($("#add_local_ip_form_group").addClass("has-error"),$("#add_local_ip_form_group").find(".help-block").html(UI.There_is_invalid_IP_or_IP_range_Exists),$("#add_local_ip_btn").prop("disabled",!0),e=1):($("#add_local_ip_form_group").removeClass("has-error"),$("#add_local_ip_form_group").find(".help-block").html(UI.Specify_an_IP__IP_range_or_MAC_address),$("#add_local_ip_btn").prop("disabled",!1)),e}function checkActiveHours(){var e=0,t=$("#hours_active").val();return validateHours(t)?($("#hours_active_container").addClass("has-error"),$("#hours_active_container").find(".warn-help").removeClass("hidden"),e=1):($("#hours_active_container").removeClass("has-error"),$("#hours_active_container").find(".warn-help").addClass("hidden")),e}function checkActiveWeek(){var e=0,t=$("#days_and_hours_active").val();return validateWeeklyRange(t)?($("#days_and_hours_active_container").addClass("has-error"),$("#days_and_hours_active_container").find(".warn-help").removeClass("hidden"),e=1):($("#days_and_hours_active_container").removeClass("has-error"),$("#days_and_hours_active_container").find(".warn-help").addClass("hidden")),e}function checkRemoteIPs(){var e=$("#remote_ip").val(),t=0;return 0!=e.length&&validateMultipleIps(e)&&validateMac(e)?($("#add_remote_ip_form_group").addClass("has-error"),$("#add_remote_ip_form_group").find(".help-block").html(UI.There_is_invalid_IP_or_IP_range_Exists),$("#add_remote_ip_btn").prop("disabled",!0),t=1):($("#add_remote_ip_form_group").removeClass("has-error"),$("#add_remote_ip_form_group").find(".help-block").html(UI.Specify_an_IP__IP_range_or_MAC_address),$("#add_remote_ip_btn").prop("disabled",!1)),t}function checkPort(e){var t=0,r=$("#"+e).val();return Validate.vaPort(r)||Validate.vaLength(r)?($("#"+e).parent().addClass("has-error"),$("#"+e).next(".help-block").removeClass("hidden"),t=1):($("#"+e).parent().removeClass("has-error"),$("#"+e).next(".help-block").addClass("hidden")),t}function checkURL(){var e=0,t=$("#url_match").val();return Validate.vaLength(t)?($("#url_input_container").addClass("has-error"),$("#url-help").removeClass("hidden"),e=1,$("#add_url_btn").prop("disabled",!0)):($("#url_input_container").removeClass("has-error"),$("#add_url_btn").prop("disabled",!1),$("#url-help").addClass("hidden")),e}function alterPortInput(e){var t=$("#"+e+"_type").val();"all"==t?($("#"+e+"_type").parent().addClass("col-sm-12").removeClass("col-sm-6"),$("#"+e).val("").parent().addClass("hidden")):($("#"+e+"_type").parent().removeClass("col-sm-12").addClass("col-sm-6"),$("#"+e).focus().val("").parent().removeClass("hidden")),"app_protocol"==e&&$("#"+e).find("option").first().prop("selected",!0)}function alterApplyTo(){var e=$("#applies_to_type").val();"all"==e?($("#ip_span_container").empty().parent().parent().addClass("hidden"),$("#add_local_ip_form_group").addClass("hidden")):($("#ip_span_container").parent().parent().removeClass("hidden"),$("#add_local_ip_form_group").removeClass("hidden")),disableSaveBtn()}function alterAllAccess(){var e=$("#all_access").prop("checked");e?$("#resources_container").addClass("hidden").find("select,input").val(""):$("#resources_container").removeClass("hidden").find("select").each(function(){$(this).find("option").first().prop("selected",!0)}),$("#remote_ip_span_container,#url_container").empty(),$("#url_container").parent().find("thead").addClass("hidden"),alterRemoteIpType(),alterUrlType(),alterPortInput("remote_port"),alterPortInput("local_port"),alterPortInput("app_protocol"),disableSaveBtn()}function alterRemoteIpType(){var e=$("#remote_ip_type").val();"all"==e?($("#remote_ip_span_container").empty().parent().parent().addClass("hidden"),$("#add_remote_ip_form_group").addClass("hidden")):($("#remote_ip_span_container").empty().parent().parent().removeClass("hidden"),$("#add_remote_ip_form_group").removeClass("hidden")),disableSaveBtn()}function alterUrlType(){var e=$("#url_type").val();"all"==e?($("#url_container").empty().parent().parent().addClass("hidden"),$("#url_match_type").parent().parent().addClass("hidden")):($("#url_container").empty().parent().parent().removeClass("hidden"),$("#url_match_type").parent().parent().removeClass("hidden")),disableSaveBtn()}function alterSchedule(){var e=$("#all_day").prop("checked"),t=$("#every_day").prop("checked");if(e&&t)$("#schedule_repeats").parent().addClass("hidden"),$("#days_container").addClass("hidden"),$("#hours_active,#days_and_hours_active").parent().parent().addClass("hidden");else if(e&&!t)$("#schedule_repeats").parent().addClass("hidden"),$("#days_container").removeClass("hidden"),$("#hours_active,#days_and_hours_active").parent().parent().addClass("hidden");else if(!e&&t)$("#schedule_repeats").parent().addClass("hidden"),$("#days_container").addClass("hidden"),$("#hours_active").parent().parent().removeClass("hidden"),$("#days_and_hours_active").parent().parent().addClass("hidden");else if(!e&&!t){$("#schedule_repeats").parent().removeClass("hidden");var r=$("#schedule_repeats").val();"daily"==r?($("#days_container").removeClass("hidden"),$("#hours_active").parent().parent().removeClass("hidden"),$("#days_and_hours_active").parent().parent().addClass("hidden")):"weekly"==r&&($("#days_container").addClass("hidden"),$("#hours_active").parent().parent().addClass("hidden"),$("#days_and_hours_active").parent().parent().removeClass("hidden"))}disableSaveBtn()}function saveChanges(){var e=["restriction_rule","whitelist_rule"],t=0;for(t=0;t<e.length;t++){var r=uciOriginal.getAllSectionsOfType(pkg,e[t]),a=0;for(a=0;a<r.length;a++){var n=uciOriginal.get(pkg,r[a],"is_ingress");"1"!=n&&uciOriginal.removeSection(pkg,r[a])}}var l=function(e){Ha.showNotify(e),uciOriginal=uci.clone(),resetData()},o=[],i=[];$("#rule_table_container").find("tr").each(function(){var e=$(this).prop("id");o.push(e)});for(var s=0;s<o.length;s++){var d=getDocumentDataFromUci(uci,o[s],!0);d.id=o[s],d.enabled=$("#"+o[s]).find('[type="checkbox"]').prop("checked")?1:0,i.push(d)}var p=[],c=[];$("#exception_table_container").find("tr").each(function(){var e=$(this).prop("id");c.push(e)});for(var s=0;s<c.length;s++){var _=getDocumentDataFromUci(uci,c[s],!0);_.id=c[s],_.enabled=$("#"+c[s]).find('[type="checkbox"]').prop("checked")?1:0,p.push(_)}var u={app:"restriction",action:"restriction_save_change",restriction_rule:i,whitelist_rule:p};$.post("/",u,l,"json")}function resetData(){var e=["restriction_rule","whitelist_rule"],t=["rule_","exception_"],r=0;for(r=0;r<e.length;r++){var a=e[r],n=t[r],l=uciOriginal.getAllSectionsOfType(pkg,a),o=new Array;for(sectionIndex=0;sectionIndex<l.length;sectionIndex++){var i=uciOriginal.get(pkg,l[sectionIndex],"is_ingress");if("1"!=i){var s=uciOriginal.get(pkg,l[sectionIndex],"description");s=""==s?l[sectionIndex]:s;var d=uciOriginal.get(pkg,l[sectionIndex],"enabled"),p=""==d||"1"==d||"true"==d,c=createEnabledCheckbox(p),_=l[sectionIndex];o.push([s,c,createEditButton(p),createRemoveButton(_),_])}}tableContainerId=n+"table_container";var u=createTrs(o);$("#"+tableContainerId).empty().append(u)}setTableBtnAction(),Ha.setFooterPosition()}function alterToRestrictionsEdit(e){$("#formModalLabel").html(UI.Edit_Restriction_Rule),$("#form_submit_btn").html(UI.Save).attr("data-type","edit-restriction").attr("data-target-id",e);var t=getDocumentDataFromUci(uci,e);setDocumentData(t),$(".del_ip_span").click(function(){$(this).parent().remove()})}function alterToRestrictionsAdd(){$("#formModalLabel").html(UI.Add_New_Restriction_Rule),$("#form_submit_btn").html(UI.Save).attr("data-type","add-restriction").attr("data-target-id","");var e=$("#rule_table_container").find("tr").length+1;emptyUci.description="rule_"+e,setDocumentData(emptyUci),disableSaveBtn()}function alterToExceptionsEdit(e){$("#formModalLabel").html(UI.Edit_Exception_Rule),$("#form_submit_btn").html(UI.Save).attr("data-type","edit-exception").attr("data-target-id",e);var t=getDocumentDataFromUci(uci,e);setDocumentData(t),$(".del_ip_span").click(function(){$(this).parent().remove()})}function alterToExceptionsAdd(){$("#formModalLabel").html(UI.Add_New_Exception_Rule),$("#form_submit_btn").html(UI.Save).attr("data-type","add-exception").attr("data-target-id","");var e=$("#exception_table_container").find("tr").length+1;emptyUci.description="exception_"+e,setDocumentData(emptyUci),disableSaveBtn()}function createTrs(e){for(var t=[],r=0;r<e.length;r++){var a='<tr id="'+e[r][4]+'"><td>'+e[r][0]+"</td><td>"+e[r][1]+"</td><td>"+e[r][2]+"</td><td>"+e[r][3]+"</td></tr>";t.push(a)}return t.join("")}function addNewRule(e){var t="restriction"==e?"rule_":"exception_",r="restriction"==e?"restriction_rule":"whitelist_rule",a=validateRule();if(a.length>0){var n={status:1,msg:a[0]+"<br>"+restStr.ARErr};Ha.showNotify(n)}else{for(var l=$("#"+t+"table_container").find("tr").length+1,o=t+""+l;""!=uci.get(pkg,o,"");)l++,o=t+""+l;setUciFromDocument(o,r,t);var i=uci.get(pkg,o,"description");i=""==i?o:i;var s=createEnabledCheckbox(!0),d=createTrs([[i,s,createEditButton(!0),createRemoveButton(o),o]]);$("#"+t+"table_container").append(d),setTableBtnAction(),$("#formModal").modal("hide"),setDocumentData(emptyUci)}}function getTableDataArray(e){var t=[];return $("#"+e).find("tr").each(function(){var e={};e.id=$(this).prop("id"),e.description=$(this).find("td").first().html(),e.enabled=$(this).find('[type="checkbox"]').prop("checked"),t.push(e)}),t}function setVisibility(e,t){e=null==e?document:e,setInvisibleIfAnyChecked([t+"all_access"],t+"resources","block",e),setInvisibleIfAnyChecked([t+"all_day"],t+"hours_active_container","block",e),setInvisibleIfAnyChecked([t+"every_day"],t+"days_active","block",e),setInvisibleIfAnyChecked([t+"all_day",t+"every_day"],t+"days_and_hours_active_container","block",e),setInvisibleIfAnyChecked([t+"all_day",t+"every_day"],t+"schedule_repeats","inline",e);var r=e.getElementById(t+"schedule_repeats");"none"!=r.style.display&&(setInvisibleIfIdMatches(t+"schedule_repeats","daily",t+"days_and_hours_active_container","block",e),setInvisibleIfIdMatches(t+"schedule_repeats","weekly",t+"days_active","block",e),setInvisibleIfIdMatches(t+"schedule_repeats","weekly",t+"hours_active_container","block",e)),setInvisibleIfIdMatches(t+"applies_to","all",t+"applies_to_container","block",e),setInvisibleIfIdMatches(t+"remote_ip_type","all",t+"remote_ip_container","block",e),setInvisibleIfIdMatches(t+"remote_port_type","all",t+"remote_port","inline",e),setInvisibleIfIdMatches(t+"local_port_type","all",t+"local_port","inline",e),setInvisibleIfIdMatches(t+"app_protocol_type","all",t+"app_protocol","inline",e),setInvisibleIfIdMatches(t+"url_type","all",t+"url_match_list","block",e)}function setInvisibleIfAnyChecked(e,t,r,a){a=null==a?document:a,r=null==r?"block":r;var n=a.getElementById(t),l=!1;for(checkIndex=0;checkIndex<e.length;checkIndex++){var o=a.getElementById(e[checkIndex]);null!=o&&(l=l||o.checked)}l&&null!=n?n.style.display="none":null!=n&&(n.style.display=r)}function setInvisibleIfIdMatches(e,t,r,a,n){n=null==n?document:n,a=null==a?"restriction_rule":a;var l=n.getElementById(r);getSelectedValue(e,n)==t&&null!=l?l.style.display="none":null!=l&&(l.style.display=a)}function createEnabledCheckbox(e){var t="checked";e||(t="");var r='<input type="checkbox" '+t+">";return r}function createEditButton(e){var t="disabled";return e&&(t=""),'<button class="btn btn-primary btn-sm" data-toggle="modal" data-target="#formModal"'+t+">"+UI.Edit+"</button>"}function createRemoveButton(e){return'<button class="btn btn-danger btn-sm" data-del-target="'+e+'">'+UI.Remove+"</button>"}function setRowEnabled(e,t){uciEnabled=t?"1":"0",uci.set(pkg,e,"enabled",uciEnabled),$("#"+e).find(".btn-primary").prop("disabled",!t)}function removeRule(e){$("#"+e).remove(),uci.removeSection(pkg,e)}function editRule(e){var t="restriction"==e?"rule_":"exception_",r="restriction"==e?"restriction_rule":"whitelist_rule",a=validateRule();if(a.length>0){var n={status:1,msg:a[0]+"<br>"+restStr.ARErr};Ha.showNotify(n)}else{var l=$("#form_submit_btn").attr("data-target-id");setUciFromDocument(l,r,t);var o=uci.get(pkg,l,"description");o=""==o?l:o;var i=createEnabledCheckbox(!0),s=createTrs([[o,i,createEditButton(!0),createRemoveButton(l),l]]);$(s).insertAfter($("#"+l)),$("#"+l).remove(),setTableBtnAction(),$("#formModal").modal("hide"),setDocumentData(emptyUci)}}function setTableBtnAction(){$("#rule_table_container").find("input").click(function(){var e=$(this).parent().parent().prop("id"),t=$(this).prop("checked");setRowEnabled(e,t)}),$("#exception_table_container").find("input").click(function(){var e=$(this).parent().parent().prop("id"),t=$(this).prop("checked");setRowEnabled(e,t)}),$("#rule_table_container").find(".btn-danger").click(function(){var e=$(this).attr("data-del-target");removeRule(e)}),$("#exception_table_container").find(".btn-danger").click(function(){var e=$(this).attr("data-del-target");removeRule(e)}),$("#rule_table_container").find(".btn-primary").click(function(){var e=$(this).parent().parent().prop("id");alterToRestrictionsEdit(e)}),$("#exception_table_container").find(".btn-primary").click(function(){var e=$(this).parent().parent().prop("id");alterToExceptionsEdit(e)})}function addAddressesToTable(e,t,r){var a=$("#"+e).val(),n=r?validateMultipleIpsOrMacs(a):validateMultipleIps(a);if(0==n){var l=[];if($("#"+t).find(".ip_span").each(function(){l.push($(this).html())}),n=0!=l.length&&testAddrOverlap(a,l.join(","))?1:0,0==n){a=a.replace(/^[\t ]*/,""),a=a.replace(/[\t ]*$/,"");var o=a.split(/[\t ]*,[\t ]*/);o.length>0&&makeIpTable(o,t),$("#"+e).val("")}}return n}function testAddrOverlap(e,t){e=e.replace(/^[\t ]+/,""),e=e.replace(/[\t ]+$/,""),t=t.replace(/^[\t ]+/,""),t=t.replace(/[\t ]+$/,"");var r,a=e.split(/[,\t ]+/),n=t.split(/[,\t ]+/),l=!1;for(r=0;r<a.length&&!l;r++){var o;for(o=0;o<n.length&&!l;o++)l=l||testSingleAddrOverlap(a[r],n[o])}return l}function testSingleAddrOverlap(e,t){var r=function(e){return e=""==e?"ALL":e.toUpperCase(),"ALL_OTHERS_COMBINED"!=e&&"ALL_OTHERS_INDIVIDUAL"!=e||(e="ALL_OTHERS_COMBINED"),e};e=r(e),t=r(t);var a=!1;if(e==t)a=!0;else if(validateMultipleIps(e)>0||validateMultipleIps(t)>0||e.match(",")||t.match(","))a=!1;else{var n=getIpRangeIntegers(e),l=getIpRangeIntegers(t);a=n[0]<=l[1]&&n[1]>=l[0]}return a}function getIpRangeIntegers(e){var t=0,r=0;if(e.match(/\//)){var a=e.split(/[\t ]*\/[\t ]*/),n=getIpInteger(a[0]),l=a[1].match(/\./)?getIpInteger(a[1]):getMaskInteger(a[1]);t=n&l,r=t|~l}else if(e.match(/-/)){var a=e.split(/[\t ]*\-[\t ]*/);t=getIpInteger(a[0]),r=getIpInteger(a[1])}else t=getIpInteger(e),r=t;return[t,r]}function getIpInteger(e){e=null==e?"":e;var t=e.match(/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/);return t?(+parsePaddedInt(t[1])<<24)+(+parsePaddedInt(t[2])<<16)+(+parsePaddedInt(t[3])<<8)+ +parsePaddedInt(t[4]):parseInt("")}function parsePaddedInt(e){for(e=null==e?"":e,e=e.replace(/[\t ]+/,"");e.length>1&&e.match(/^0/)||e.length>2&&e.match(/^\-0/);)e=e.replace(/^0/,""),e=e.replace(/^\-0/,"-");return parseInt(e)}function makeIpTable(e,t){for(var r=0;r<e.length;r++){var a='<span class="ip_spans"><span class="ip_span">'+e[r]+'</span>&nbsp;<span class="del_ip_span" title="delete this ip(s)">&times;</span>&nbsp;&nbsp;&nbsp;&nbsp;</span><wbr>';$("#"+t).append(a),$(".del_ip_span").click(function(){$(this).parent().remove()})}}function validateMac(e){var t=0,r=e.split(/:/);if(6!=r.length)t=2;else for(fieldIndex=0;fieldIndex<6&&0==t;fieldIndex++)field=r[fieldIndex],null==field.match(/^[0123456789ABCDEFabcdef]{2}$/)&&(t=1);return t}function addUrlToTable(e,t,r){var a=$("#"+e).val(),n=$("#"+t).val(),l=validateUrl(a,t);if(0==l){var o=createUrlSpan(a),i=n.match("domain")?"domain":"full",s=n.substring(n.lastIndexOf("_")+1),d="<tr><td>"+i+"</td><td>"+s+"</td><td>"+o+'</td><td><button class="btn btn-danger btn-sm del_url_btn">Remove</button></td></tr>';$("#"+r).append(d).parent().find("thead").removeClass("hidden"),$("#"+e).val(""),$("#"+t).find("option").first().prop("selected",!0),$(".del_url_btn").click(function(){return $(this).parent().parent().remove(),$("#"+r).find("tr").length||$("#"+r).parent().find("thead").addClass("hidden"),!1})}else 0==a.length?alert(restStr.UMZErr):alert(restStr.UChErr+"\n")}function validateRule(){var e=["hours_active","days_and_hours_active","remote_port","local_port"],t=["hours_active_label","days_and_hours_active_label","remote_port_label","local_port_label"],r=[validateHours,validateWeeklyRange,validateMultiplePorts,validateMultiplePorts],a=[0,0,0,0],n=["hours_active_container","days_and_hours_active_container","remote_port_container","local_port_container"];return $("#all_access").prop("checked")&&(n[2]="resources_container",n[3]="resources_container"),proofreadFields(e,t,r,a,n)}function validateHours(e){var t=e.match(/,/)?e.split(/,/):[e],r=!0;for(commaIndex=0;commaIndex<t.length&&r;commaIndex++){var a=t[commaIndex].split(/-/),n=2==a.length;n&&(n=n&&a[0].match(/^[\t ]*([0-1]?[0-9]|2[0-3])(:[0-5][0-9])?[\t ]*$/),n=n&&a[1].match(/^[\t ]*([0-1]?[0-9]|2[0-3])(:[0-5][0-9])?[\t ]*$/)),r=r&&n}return r?0:1}function validateWeeklyRange(e){var t=e.match(/,/)?e.split(/,/):[e],r=!0;for(commaIndex=0;commaIndex<t.length&&r;commaIndex++){var a=t[commaIndex].split(/-/),n=2==a.length;if(n){var l=new RegExp("^[\\t ]*("+UI.Sun+"|"+UI.Mon+"|"+UI.Tue+"|"+UI.Wed+"|"+UI.Thu+"|"+UI.Fri+"|"+UI.Sat+")[\\t ]*([0-1]?[0-9]|2[0-3])(:[0-5]?[0-9])?(:[0-5]?[0-9])?[\\t ]*$");n=n&&a[0].match(l),n=n&&a[1].match(l)}r=r&&n}return r?0:1}function proofreadFields(e,t,r,a,n){var l=new Array;for(idIndex in e)isVisible=!0,null!=n&&null!=n[idIndex]&&(isVisible=!$("#"+n[idIndex]).hasClass("hidden")),isVisible&&(f=r[idIndex],proofreadText(e[idIndex],f,a[idIndex]),f($("#"+e[idIndex]).val())!=a[idIndex]&&(labelStr=t[idIndex]+"",null!=$("#"+t[idIndex])?labelStr=$("#"+t[idIndex]).html():alert("error in proofread: label with id "+t[idIndex]+" is not defined"),l.push(UI.prfErr+" "+labelStr)));return l}function proofreadText(e,t,r){$("#"+e).css("color",t($("#"+e).val())==r?"black":"red")}function validateMultipleIps(e){e=e.replace(/^[\t ]+/g,""),e=e.replace(/[\t ]+$/g,"");for(var t=e.split(/[\t ]*,[\t ]*/),r=t.length>0?0:1;0==r&&t.length>0;){var a=t.pop();if(a.match(/-/)){var n=a.split(/[\t ]*-[\t ]*/);r=2==n.length&&0==validateIP(n[0])&&0==validateIP(n[1])?0:1}else r=validateIpRange(a)}return r}function proofreadMultipleIps(e){proofreadText(e,validateMultipleIps,0)}function proofreadMultipleIpsOrMacs(e){proofreadText(e,validateMultipleIpsOrMacs,0)}function validateIpRange(e){var t=1;if(e.indexOf("/")>0){var r=e.split("/");if(2==r.length){var a=validateIP(r[0]),n=0==validateNetMask(r[1])||0==validateNumericRange(r[1],1,31)?0:1;t=0==a&&0==n?0:1}}else t=validateIP(e);return t}function validateMultipleIpsOrMacs(e){var t=e.replace(/^[\t ]+/g,"");t=t.replace(/[\t ]+$/g,"");for(var r=t.split(/[\t ]*,[\t ]*/),a=r.length>0?0:1;0==a&&r.length>0;){var n=r.pop();if(n.match(/-/)){var l=n.split(/[\t ]*-[\t ]*/);a=2==l.length&&0==validateIP(l[0])&&0==validateIP(l[1])?0:1}else a=n.match(/:/)?validateMac(n):validateIpRange(n)}return a}function validateMultiplePorts(e){e=e.replace(/^[\t ]+/g,""),e=e.replace(/[\t ]+$/g,"");var t=e.match(/,/)?e.split(/[\t ]*,[\t ]*/):[e],r=!0;for(splitIndex=0;splitIndex<t.length;splitIndex++)t[splitIndex].replace(/^[\t ]+/g,""),t[splitIndex].replace(/[\t ]+$/g,""),r=r&&0==validatePortOrPortRange(t[splitIndex]);return r?0:1}function validateIP(e){var t=0;if("0.0.0.0"==e)t=1;else if("255.255.255.255"==e)t=2;else{var r=e.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);if(null==r)t=5;else for(field=1;field<=4;field++)r[field]>255&&(t=4),255==r[field]&&4==field&&(t=3)}return t}function proofreadMultiplePorts(e){proofreadText(e,validateMultiplePorts,0)}function validatePortOrPortRange(e){var t=0;if(null!=e.match(/-/)){var r=e.split(/-/);r.length>2?t=5:(error1=validateNumericRange(r[0],1,65535),error2=validateNumericRange(r[1],1,65535),t=error1+10*error2,0==t&&(t=r[1]-r[0]>=0?0:4))}else t=validateNumericRange(e,1,65535);return t}function validateNumericRange(e,t,r){var a=null==e.match(/^[\d]+$/)?1:0;return 0==a&&(a=e<t?2:0),0==a&&(a=e>r?3:0),a}function validateUrl(e,t){var r=($("#"+t),e.match(/[\n\r\"\']/)||0==e.length?1:0);return r}function proofreadUrl(e){proofreadText(e,validateUrl,0)}function createUrlSpan(e){for(var t=[];e.length>0;){var r=e.substr(0,30);e=e.substr(30),t.push(e.length>0?r+"-":r)}for(var a="";t.length>0;)a+=t.shift(),t.length>0&&(a+="<br>");return a}function parseUrlSpan(e){var t=e.childNodes,r="";for(childIndex=0;childIndex<t.length;childIndex++)if(childIndex%2==0){var a=t[childIndex].data;childIndex<t.length-1&&(a=a.substr(0,a.length-1)),r+=a}return r}function getDocumentDataFromUci(e,t,r){var a={},n=e.get(pkg,t,"description");a.description=""==n?t:n;var l=getOptionsAndTypeFromUci(e,pkg,t,"local_addr");a.local_addr_type=l.type,a.local_addr_option=l.optionValue;var o=e.get(pkg,t,"active_weekly_ranges");a.daysAndHours=weekly_i18n(o,"uci");var s=e.get(pkg,t,"active_hours"),d=""==o&&""==s;a.hours=s,a.allDay=d,a.scheduleRepeats=""==o?"daily":"weekly";var p=["sun","mon","tue","wed","thu","fri","sat"],c=e.get(pkg,t,"active_weekdays"),_=[];_=""==c?p:c.split(/,/),a.days=_;var u=""==o,h=0;for(h=0;h<p.length;h++){var v=p[h],m=!1,f=0;for(f=0;f<_.length&&!m;f++)m=_[f]==v;u=u&&m}a.everyDay=u;var I=getOptionsAndTypeFromUci(e,pkg,t,"remote_addr");a.remote_ip_type=I.type,a.remote_ip_option=I.optionValue;var g=getOptionsAndTypeFromUci(e,pkg,t,"local_port");a.local_port_type=g.type,a.local_port_option=g.optionValue;var y=getOptionsAndTypeFromUci(e,pkg,t,"remote_port");a.remote_port_type=y.type,a.remote_port_option=y.optionValue;var b=e.get(pkg,t,"proto");a.transport_protocol="tcp"!=b&&"udp"!=b?"both":b;var $=e.get(pkg,t,"app_proto"),k=""==$?"except":"only";a.app_protocol=""==$?e.get(pkg,t,"not_app_proto"):$,a.app_protocol_type=""==$?"all":k;var U=["url_contains","url_regex","url_exact","url_domain_contains","url_domain_regex","url_domain_exact"],S=["contains","regex","exact","contains","regex","exact"],x=["full","full","full","domain","domain","domain"],R="",C=[],A=!1,T=0,P="all";for(T=0;T<U.length;T++)C[T]=e.get(pkg,t,U[T]),A=""!=C[T]||A,P=""!=C[T]?"only":P;if(!A)for(R="not_",T=0;T<U.length;T++)C[T]=e.get(pkg,t,R+U[T]),A=""!=C[T]||A,P=""!=C[T]?"except":P;if(A){var E=[];for(T=0;T<U.length;T++){var B=C[T];if(""!=B){B=B.replace(/^[\t ]*\"/,""),B=B.replace(/\"[\t ]*$/,""),def=B.match(/\".*\"/)?B.split(/\"[\t, ]*\"/):[B];var D=0;for(D=0;D<def.length;D++)E.push([x[T],S[T],def[D],'<button class="btn btn-danger btn-sm del_url_btn">Remove</button>',def[D]])}}}a.url_type=P,a.url_data="undefined"!=typeof E?E:"";var M=!0,w=["remote_ip_type","remote_port_type","local_port_type","transport_protocol","app_protocol_type","url_type"];for(typeIndex=0;typeIndex<w.length;typeIndex++){var F=a[w[typeIndex]];M=M&&("all"==F||"both"==F)}if(a.all_resources_blocked=M,r){var O={};for(O.description=a.description,O.not_local_addr=e.get(pkg,t,"not_local_addr"),O.local_addr=e.get(pkg,t,"local_addr"),O.active_weekly_ranges=e.get(pkg,t,"active_weekly_ranges"),O.active_hours=a.hours,O.active_weekdays=c,O.remote_addr=e.get(pkg,t,"remote_addr"),O.not_remote_addr=e.get(pkg,t,"not_remote_addr"),O.local_port=e.get(pkg,t,"local_port"),O.not_local_port=e.get(pkg,t,"not_local_port"),O.remote_port=e.get(pkg,t,"remote_port"),O.not_remote_port=e.get(pkg,t,"not_remote_port"),O.proto=e.get(pkg,t,"proto"),O.app_proto=e.get(pkg,t,"app_proto"),O.not_app_proto=e.get(pkg,t,"not_app_proto"),i=0;i<U.length;i++)O[U[i]]=e.get(pkg,t,U[i]),O["not_"+U[i]]=e.get(pkg,t,"not_"+U[i]);return O}return a}function setDocumentData(e){if($("#name").val(e.description),$("#applies_to_type").val(e.local_addr_type),alterApplyTo(),e.local_addr_option){var t=e.local_addr_option.split(","),r=setIpTable(t);$("#ip_span_container").empty().append(r)}if($("#all_day").prop("checked",e.allDay),$("#every_day").prop("checked",e.everyDay),$("#schedule_repeats").val(e.scheduleRepeats||"daily"),alterSchedule(),e.daysAndHours&&$("#days_and_hours_active").val(e.daysAndHours),e.hours&&$("#hours_active").val(e.hours),$("#all_access").prop("checked",e.all_resources_blocked),alterAllAccess(),$("#remote_ip_type").val(e.remote_ip_type),alterRemoteIpType(),e.remote_ip_option){var t=e.remote_ip_option.split(","),r=setIpTable(t);$("#remote_ip_span_container").empty().append(r)}if($("#remote_port_type").val(e.remote_port_type),alterPortInput("remote_port"),$("#remote_port").val(e.remote_port_option),$("#local_port_type").val(e.local_port_type),alterPortInput("local_port"),$("#local_port").val(e.local_port_option),$("#transport_protocol").val(e.transport_protocol),$("#app_protocol_type").val(e.app_protocol_type),alterPortInput("app_protocol"),$("#app_protocol").val(e.app_protocol),$("#url_type").val(e.url_type),alterUrlType(),e.url_data&&e.url_data.length>0){var a=createTrs(e.url_data);$("#url_container").empty().append(a).parent().find("thead").removeClass("hidden"),$(".del_url_btn").click(function(){return $(this).parent().parent().remove(),$("#url_container").find("tr").length||$("#url_container").parent().find("thead").addClass("hidden"),!1})}}function setIpTable(e){for(var t=[],r=0;r<e.length;r++)t.push('<span class="ip_spans"><span class="ip_span">'+e[r]+'</span><span class="del_ip_span">&times;</span>&nbsp;&nbsp;&nbsp;&nbsp;</span>');return t.join("")}function getOptionsAndTypeFromUci(e,t,r,a){var n=e.get(t,r,a),l="only";""==n&&(n=e.get(t,r,"not_"+a),l=""!=n?"except":"all");var o={optionValue:n,type:l};return o}function setUciFromDocument(e,t,r){if(uci.removeSection(pkg,e),uci.set(pkg,e,"",t),uci.set(pkg,e,"is_ingress","0"),uci.set(pkg,e,"",t),uci.set(pkg,e,"description",$("#name").val()),setFromIpTable(pkg,e,"local_addr","ip_span_container"),!$("#days_container").hasClass("hidden")){var a=[],n=["sun","mon","tue","wed","thu","fri","sat"];for(dayIndex=0;dayIndex<n.length;dayIndex++)$("#rule_"+n[dayIndex]).prop("checked")&&a.push(n[dayIndex]);var l=a.join(",");uci.set(pkg,e,"active_weekdays",l)}setIfVisible(pkg,e,"active_hours","hours_active","hours_active_container");var o=$("#days_and_hours_active");if(o.val(weekly_i18n(o.val(),"table")),setIfVisible(pkg,e,"active_weekly_ranges","days_and_hours_active","days_and_hours_active_container"),!$("#all_access").prop("checked")){setFromIpTable(pkg,e,"remote_addr","remote_ip_span_container"),setIfVisible(pkg,e,"remote_port","remote_port","remote_port","remote_port_type"),setIfVisible(pkg,e,"local_port","local_port","local_port","local_port_type"),uci.set(pkg,e,"proto",$("#transport_protocol").val());var i=$("#app_protocol_type").val();if("all"!=i){var s="except"==i?"not_":"";uci.set(pkg,e,s+"app_proto",$("#app_protocol").val())}var d=$("#url_type").val();if("all"!=d&&""!=$("#url_container").html()){var p,c=getUrlFromTable(),_="except"==d?"not_":"",u=[];for(p=0;p<c.length;p++){var h=c[p][0];h=(h.match("domain")?"url_domain_":"url_")+c[p][1],urlStr=c[p][2],null!=u[h]?u[h]=u[h]+',"'+urlStr+'"':u[h]='"'+urlStr+'"'}var v=["url_","url_domain_"],m=["exact","contains","regex"],f=0,I=0;for(f=0;f<2;f++)for(I=0;I<3;I++){var g=v[f]+m[I];null!=u[g]&&uci.set(pkg,e,_+g,u[g])}}}}function setDocumentFromUci(e,t,r,a,n){e=null==e?document:e;var l=t.get(pkg,r,"description");l=""==l?r:l,$("#"+n+"name").val(l);var o=t.get(pkg,r,"active_weekly_ranges"),i=t.get(pkg,r,"active_hours"),s=""==o&&""==i;e.getElementById(n+"hours_active").value=i,e.getElementById(n+"all_day").checked=s,e.getElementById(n+"days_and_hours_active").value=weekly_i18n(o,"uci"),setSelectedValue(n+"schedule_repeats",""==o?"daily":"weekly",e);var d=["sun","mon","tue","wed","thu","fri","sat"],p=t.get(pkg,r,"active_weekdays"),c=[];c=""==p?d:p.split(/,/);var _=""==o,u=0;for(u=0;u<d.length;u++){var h=d[u],v=!1,m=0;for(m=0;m<c.length&&!v;m++)v=c[m]==h;_=_&&v,e.getElementById(n+d[u]).checked=v}e.getElementById(n+"every_day").checked=_,setIpTableAndSelectFromUci(e,t,pkg,r,"remote_addr",n+"remote_ip_table_container",n+"remote_ip_table",n+"remote_ip_type",n+"remote_ip"),setTextAndSelectFromUci(e,t,pkg,r,"remote_port",n+"remote_port",n+"remote_port_type"),setTextAndSelectFromUci(e,t,pkg,r,"local_port",n+"local_port",n+"local_port_type");var f=t.get(pkg,r,"proto");f="tcp"!=f&&"udp"!=f?"both":f,setSelectedValue(n+"transport_protocol",f,e);var I=t.get(pkg,r,"app_proto"),g=""==I?"except":"only";I=""==I?t.get(pkg,r,"not_app_proto"):I,g=""==I?"all":g,setSelectedValue(n+"app_protocol_type",g,e),setSelectedValue(n+"app_protocol",I,e);var y=["url_contains","url_regex","url_exact","url_domain_contains","url_domain_regex","url_domain_exact"],b=["contains","regex","exact","contains","regex","exact"],k=["full","full","full","domain","domain","domain"],U="",S=[],x=!1,R=0,C="all";for(R=0;R<y.length;R++)S[R]=t.get(pkg,r,y[R]),x=""!=S[R]||x,C=""!=S[R]?"only":C;if(!x)for(U="not_",R=0;R<y.length;R++)S[R]=t.get(pkg,r,U+y[R]),x=""!=S[R]||x,C=""!=S[R]?"except":C;setSelectedValue(n+"url_type",C,e);var A=e.getElementById(n+"url_match_table_container");if(A.childNodes.length>0&&A.removeChild(A.firstChild),x){var T=createTable([restStr.UPrt,restStr.MTyp,restStr.MTExp],[],n+"url_match_table",!0,!1,null,null,e);for(R=0;R<y.length;R++){var P=S[R];if(""!=P){P=P.replace(/^[\t ]*\"/,""),P=P.replace(/\"[\t ]*$/,""),def=P.match(/\".*\"/)?P.split(/\"[\t, ]*\"/):[P];var E=0;for(E=0;E<def.length;E++)addTableRow(T,[k[R],b[R],createUrlSpan(def[E],e)],!0,!1,null,null,e)}}A.appendChild(T)}e.getElementById(n+"url_match").value="";var B=!0,D=["remote_ip_type","remote_port_type","local_port_type","transport_protocol","app_protocol_type","url_type"];for(typeIndex=0;typeIndex<D.length;typeIndex++){var M=getSelectedValue(n+D[typeIndex],e);B=B&&("all"==M||"both"==M)}e.getElementById(n+"all_access").checked=B,setVisibility(e,n)}function setIpTableAndSelectFromUci(e,t,r,a,n,l,o,i,s){e=null==e?document:e;var d=t.get(r,a,n),p="only";""==d&&(d=t.get(r,a,"not_"+n),p=""!=d?"except":"all"),setSelectedValue(i,p,e);var c=e.getElementById(l);if(c.childNodes.length>0&&c.removeChild(c.firstChild),""!=d){d=d.replace(/^[\t ]*/,""),d=d.replace(/[\t ]*$/,"");for(var _=d.split(/[\t ]*,[\t ]*/),u=createTable([""],[],o,!0,!1,null,null,e);_.length>0;)addTableRow(u,[_.shift()],!0,!1,null,null,e);c.appendChild(u),e.getElementById(s).value=""}}function setTextAndSelectFromUci(e,t,r,a,n,l,o){e=null==e?document:e;var i=t.get(r,a,n),s="only";""==i&&(i=t.get(r,a,"not_"+n),s=""!=i?"except":"all"),setSelectedValue(o,s,e),e.getElementById(l).value=i}function setIfVisible(e,t,r,a,n,l){if(!$("#"+n).hasClass("hidden")){var o=$("#"+a).val();null!=l&&(prefixValue=$("#"+l).val(),r="except"==prefixValue?"not_"+r:r),uci.set(e,t,r,o)}}function setFromIpTable(e,t,r,a){var n=$('[remote_ip="'+r+'"]').val(),l=$("#"+a).html();if("all"!=n&&""!=l){var o=[];$("#"+a).find(".ip_span").each(function(){o.push($(this).html())});var i="";for(ipIndex=0;ipIndex<o.length;ipIndex++)i=i+o[ipIndex]+",";if(i=i.replace(/,$/,""),i.length>0){var s="except"==n?"not_":"";uci.set(e,t,s+r,i)}}}function getUrlFromTable(){var e=[];return $("#url_container").find("tr").each(function(){var t=[];$(this).find("td").each(function(e){e<3&&t.push($(this).html())}),e.push(t)}),e}function weekly_i18n(e,t){if(e.length<6)return e;var r,a,n,l,o=[UI.Sun,UI.Mon,UI.Tue,UI.Wed,UI.Thu,UI.Fri,UI.Sat],i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=[];for("uci"==t?(r=i,a=o):(r=o,
a=i),n=e.split(" "),l=0;l<n.length;l++){var d=r.indexOf(n[l]);d>=0?s[l]=a[d]:s[l]=n[l]}return s.join(" ")}function createInput(e,t){t=null==t?document:t;try{inp=t.createElement("input"),inp.type=e}catch(r){inp=t.createElement('<input type="'+e+'" />')}return inp.outerHTML}function setSelectedValue(e,t,r){var r=null==r?document:r,a=r.getElementById(e);null==a&&alert(UI.Err+": "+e+" "+UI.nex);var n=!1;for(optionIndex=0;optionIndex<a.options.length&&!n;optionIndex++)n=a.options[optionIndex].value==t,n&&(a.selectedIndex=optionIndex);!n&&a.options.length>0&&a.selectedIndex<0&&(a.selectedIndex=0)}$("#applies_to_type").change(alterApplyTo),$("#all_access").click(alterAllAccess),$("#remote_ip_type").change(alterRemoteIpType),$("#url_type").change(alterUrlType),$("#remote_port_type").change(function(){alterPortInput("remote_port"),disableSaveBtn()}),$("#local_port_type").change(function(){alterPortInput("local_port"),disableSaveBtn()}),$("#app_protocol_type").change(function(){alterPortInput("app_protocol"),disableSaveBtn()}),$("#all_day").click(alterSchedule),$("#every_day").click(alterSchedule),$("#schedule_repeats").change(alterSchedule),$("#add_new_restrictions_btn").click(alterToRestrictionsAdd),$("#add_new_exceptions_btn").click(alterToExceptionsAdd),$("#form_submit_btn").click(function(){var e=$("#form_submit_btn").attr("data-type"),t=e.split("-")[0],r=e.split("-")[1];"edit"==t?(editRule(r),Ha.setFooterPosition()):(addNewRule(r),Ha.setFooterPosition())}),$("#applies_to_addr").focus(function(){$("#add_local_ip_form_group").find(".help-block").html(UI.Specify_an_IP__IP_range_or_MAC_address)}),$("#applies_to_addr").bind("keyup blur",function(){checkLocalIPs(),disableSaveBtn()}),$("#add_local_ip_btn").click(function(){var e=addAddressesToTable("applies_to_addr","ip_span_container",!0);return e&&($("#add_local_ip_form_group").find(".help-block").html(UI.There_is_invalid_IP_or_IP_range_Exists),$("#applies_to_addr").focus()),!1}),$("#hours_active").bind("keyup blur",function(){checkActiveHours(),disableSaveBtn()}),$("#days_and_hours_active").bind("keyup blur",function(){checkActiveWeek(),disableSaveBtn()}),$("#remote_ip").focus(function(){$("#add_remote_ip_form_group").find(".help-block").html(UI.Specify_an_IP__IP_range_or_MAC_address)}),$("#remote_ip").bind("keyup blur",function(){checkRemoteIPs(),disableSaveBtn()}),$("#add_remote_ip_btn").click(function(){var e=addAddressesToTable("remote_ip","remote_ip_span_container",!0);return e&&($("#add_remote_ip_form_group").find(".help-block").html(UI.There_is_invalid_IP_or_IP_range_Exists),$("#remote_ip").focus()),!1}),$("#local_port").bind("blur keyup",function(){checkPort("local_port"),disableSaveBtn()}),$("#remote_port").bind("blur keyup",function(){checkPort("remote_port"),disableSaveBtn()}),$("#url_match").bind("blur keyup",function(){checkURL()}),$("#add_url_btn").click(function(){addUrlToTable("url_match","url_match_type","url_container")}),UI.SaveChanges="Save Changes",UI.Reset="Reset",UI.Clear="Clear History",UI.Delete="Delete Data",UI.DNow="Download Now",UI.Visited="Visited Sites",UI.Requests="Search Requests",UI.Add="Add",UI.DDNSService="DDNS Service",UI.WakeUp="Wake Up",UI.NewRule="Add New Rule",UI.NewQuota="Add New Quota",UI.AddRule="Add Rule",UI.AddSvcCls="Add Service Class",UI.Select="Select",UI.ChPRoot="Change Plugin Root",UI.AddPSource="Add Plugin Source",UI.Uninstall="Uninstall",UI.Install="Install",UI.RefreshPlugins="Refresh Plugins",UI.GetBackup="Get Backup Now",UI.RestoreConfig="Restore Configuration Now",UI.RestoreDefault="Restore Default Configuration Now",UI.Upgrade="Upgrade Now",UI.Reboot="Reboot Now",UI.MoreInfo="More Info",UI.Hide="Hide Text",UI.WaitSettings="Please wait while new settings are applied. . .",UI.Wait="Please wait. . .",UI.ErrChanges="Changes could not be applied",UI.Always="Always",UI.Disabled="Disabled",UI.Enabled="Enabled",UI.Sunday="Sunday",UI.Monday="Monday",UI.Tuesday="Tuesday",UI.Wednesday="Wednesday",UI.Thursday="Thursday",UI.Friday="Friday",UI.Saturday="Saturday",UI.Sun="Sun",UI.Mon="Mon",UI.Tue="Tue",UI.Wed="Wed",UI.Thu="Thu",UI.Fri="Fri",UI.Sat="Sat",UI.unk="unknown",UI.HsNm="Hostname",UI.HDsp="Host Display",UI.DspHn="Display Hostnames",UI.DspHIP="Display Host IPs",UI.never="never",UI.disabled="disabled",UI.both="both",UI.seconds="seconds",UI.minutes="minutes",UI.hours="hours",UI.days="days",UI.second="second",UI.minute="minute",UI.hour="hour",UI.day="day",UI.month="month",UI.year="year",UI.sc="s",UI.hr="hr",UI.pAM="",UI.pPM="",UI.hAM="AM",UI.hPM="PM",UI.EMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],UI.byt="bytes",UI.Bu="B",UI.KB="kB",UI.MB="MB",UI.GB="GB",UI.TB="TB",UI.KB1="kByte",UI.MB1="MByte",UI.GB1="GByte",UI.TB1="TByte",UI.KBy="kBytes",UI.MBy="MBytes",UI.GBy="GBytes",UI.TBy="TBytes",UI.Kbs="kbits/s",UI.KBs="kBytes/s",UI.MBs="MBytes/s",UI.CApplyChanges="Close and Apply Changes",UI.CDiscardChanges="Close and Discard Changes",UI.waitText="Please Wait While Settings Are Applied",UI.Cancel="Cancel",UI.Err="ERROR",UI.prfErr="There is an error in",UI.nex="does not exist",UI.InvAdd="ERROR: Invalid Address",UI.CPass="Confirm Password",UI.OK="OK",UI.VPass="Verifying Password...",UI.sprt="SSH port",UI.wsprt="web server port",UI.prdr="port redirected to router",UI.puse="port in use by router",UI.pfwd="port forwarded to",UI.conn="connected",UI.AJAX="AJAX Browser Support Needed",UI.AJAXUpg="Please upgrade to an AJAX compatible browser and try again. Such browsers include Firefox 2.0+, Safari and IE 6+.";var restStr=new Object;restStr.ARSect="Access Restrictions",restStr.NRRule="New Restriction Rule",restStr.ANRule="Add New Rule",restStr.CRestr="Current Restrictions",restStr.EWSect="Exceptions (White List)",restStr.NExcp="New Exception",restStr.CExcp="Current Exceptions",restStr.ERSect="Edit Restriction Rule",restStr.EESect="Edit Exception Rule",restStr.RDesc="Rule Description",restStr.RAppl="Rule Applies To",restStr.AHsts="All Hosts",restStr.EHsts="All Hosts Except",restStr.OHsts="Only The Following Hosts",restStr.Schd="Schedule",restStr.ADay="All Day",restStr.EDay="Every Day",restStr.DSchd="Schedule Repeats Daily",restStr.WSchd="Schedule Repeats Weekly",restStr.DActv="Days Active",restStr.HActv="Hours Active",restStr.DHActv="Days And Hours Active",restStr.Sample="e.g. Mon 00:30 - Thu 13:15, Fri 14:00 - Fri 15:00",restStr.SSample="e.g.",restStr.RRsrc="Restricted Resources",restStr.NetAcc="All Network Access",restStr.RemIP="Remote IP(s)",restStr.RemPrt="Remote Port(s)",restStr.LclPrt="Local Port(s)",restStr.TrProto="Transport Protocol",restStr.ApProto="Application Protocol",restStr.WebURL="Website URL(s)",restStr.BlAll="Block All",restStr.BlOny="Block Only",restStr.BlExc="Block All Except",restStr.BlTCP="Block TCP",restStr.BlUDP="Block UDP",restStr.FUExt="Full URL matches exactly",restStr.FUCnt="Full URL contains",restStr.FURgx="Full URL matches Regex",restStr.DmExt="Domain matches exactly",restStr.DmCon="Domain contains",restStr.DmRgx="Domain matches Regex",restStr.ESect="Exception Description",restStr.EAppl="Exception Applies To",restStr.PRsrc="Permitted Resources",restStr.PmAll="Permit All",restStr.PmOny="Permit Only",restStr.PmExc="Permit All Except",restStr.PmTCP="Permit TCP",restStr.PmUDP="Permit UDP",restStr.ARErr="Could not add rule.",restStr.IAErr="ERROR: Invalid Address",restStr.UPrt="URL Part",restStr.MTyp="Match Type",restStr.MTExp="Match Text / Expression",restStr.UMZErr="ERROR: URL match length must be greater than zero",restStr.UChErr="ERROR: URL match cannot contain quote or newline characters";var pkg="restriction_uci";resetData();var emptyUci={description:"",local_addr_type:"all",local_addr_option:"",allDay:!0,everyDay:!0,scheduleRepeats:"",days:"",hours:"",daysAndHours:"",all_resources_blocked:!0,app_protocol_type:"",app_protocol:"",local_port_option:"",local_port_type:"",remote_ip_option:"",remote_ip_type:"",remote_port_option:"",remote_port_type:"",transport_protocol:"",url_data:"",url_type:""};$("#save_page_btn").click(saveChanges),$("#reset_page_btn").click(resetData);